CommonSecurityLog
| where TimeGenerated > ago(30d)
| extend bag = pack_all() 
| mv-expand key = bag_keys(bag)
| extend keyStr = tostring(key)          // ✅ cast dynamic → string
| where isnotempty(bag[keyStr])          // now it works as proper string index
| distinct keyStr